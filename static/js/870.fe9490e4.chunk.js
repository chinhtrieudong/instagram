"use strict";(self.webpackChunkinstagram=self.webpackChunkinstagram||[]).push([[870],{660:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(43),o=s(475),r=s(753),l=s(167),a=s(210),i=s(579);const c=()=>{const{firebaseApp:e}=(0,n.useContext)(r.A),{user:t}=(0,n.useContext)(l.A);return(0,i.jsx)("header",{className:"h-16 bg-white border-b border-gray-primary mb-8",children:(0,i.jsx)("div",{className:"container mx-auto max-w-screen-lg h-full",children:(0,i.jsxs)("div",{className:"flex justify-between h-full",children:[(0,i.jsx)("div",{className:"text-gray-700 text-center flex items-center cursor-pointer",children:(0,i.jsx)("h1",{className:"flex justify-center w-full",children:(0,i.jsx)(o.N_,{to:a.$Q,"aria-label":"Instagram logo",children:(0,i.jsx)("img",{src:"/images/Instagram_logo.svg.png",alt:"Instagram",className:"mt-2 w-2/12"})})})}),(0,i.jsx)("div",{className:"text-gray-700 text-center flex items-center align-items",children:t?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.N_,{to:a.$Q,"aria-label":"Dashboard",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-8 mr-6 text-black-light cursor-pointer",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})})}),(0,i.jsx)("button",{type:"button",title:"Sign out",onClick:()=>e.auth().signOut(),onKeyDown:t=>{"Enter"===t.key&&e.auth().signOut()},children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-8 mr-6 text-black-light cursor-pointer",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})})}),(0,i.jsx)("div",{className:"flex items-center w-8 h-8 cursor-pointer",children:(0,i.jsx)(o.N_,{to:"/p/".concat(t.displayName),children:(0,i.jsx)("img",{className:"rounded-full h-8 w-8 flex",src:"/images/avatars/".concat(t.displayName,".jpg"),alt:"".concat(t.displayName," profile")})})})]})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.N_,{to:a.S3,children:(0,i.jsx)("button",{type:"button",className:"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8",children:"Log In"})}),(0,i.jsx)(o.N_,{to:a.OE,children:(0,i.jsx)("button",{type:"button",className:"font-bold text-sm rounded text-blue-medium w-20 h-8",children:"Sign Up"})})]})})]})})})}},154:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(43),o=s(167),r=s(600);function l(){const[e,t]=(0,n.useState)({}),{user:s}=(0,n.useContext)(o.A);return(0,n.useEffect)((()=>{null!==s&&void 0!==s&&s.uid&&async function(){const[e]=await(0,r.JP)(s.uid);t(e)}()}),[s]),{user:e}}},870:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var n=s(43),o=s(216),r=s(600),l=s(210),a=s(660),i=s(154),c=s(372),d=s(579);const u=e=>{let{photosCount:t,followerCount:s,setFollowerCount:o,profile:{docId:l,userId:a,fullName:u,followers:m=[],following:h=[],username:f}}=e;const{user:x}=(0,i.A)(),[g,p]=(0,n.useState)(!1),w=x.username&&x.username!==f,j=async()=>{p((e=>!e)),o({followerCount:g?m.length-1:m.length+1}),await(0,r.So)(g,x.docId,l,a,x.userId)};return(0,n.useEffect)((()=>{x.username&&a&&(async()=>{const e=await(0,r.K3)(x.username,a);p(!!e)})()}),[x.username,a]),(0,d.jsxs)("div",{className:"grid grid-cols-4 gap-4 justify-between mx-auto max-w-screen-lg",children:[(0,d.jsx)("div",{className:"container flex justify-center",children:x.username&&(0,d.jsx)("img",{className:"rounded-full h-40 w-40 flex",alt:"".concat(x.userId," profile"),src:"/images/avatars/".concat(f,".jpg")})}),(0,d.jsxs)("div",{className:"flex items-center justify-center flex-col col-span-2",children:[(0,d.jsxs)("div",{className:"container flex items-center",children:[(0,d.jsx)("p",{className:"text-2xl mr-4",children:f}),w&&(0,d.jsx)("button",{className:"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8",type:"button",onClick:j,onKeyDown:e=>{"Enter"===e.key&&j()},children:g?"Unfollow":"Follow"})]}),(0,d.jsx)("div",{className:"container flex mt-4",children:void 0===m||void 0===h?(0,d.jsx)(c.A,{count:1,height:24,width:677}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("p",{className:"mr-10",children:[(0,d.jsx)("span",{className:"font-bold",children:t})," ","photos"]}),(0,d.jsxs)("p",{className:"mr-10",children:[(0,d.jsx)("span",{className:"font-bold",children:s})," ",s<2?"follower":"followers"]}),(0,d.jsxs)("p",{className:"mr-10",children:[(0,d.jsx)("span",{className:"font-bold",children:h.length})," ",1===m.length?"following":"followings"]})]})}),(0,d.jsx)("div",{className:"container mt-4",children:(0,d.jsx)("p",{className:"font-medium",children:u||(0,d.jsx)(c.A,{count:1,height:24})})})]})]})};function m(e){let{photos:t}=e;return(0,d.jsxs)("div",{className:"h-16 border-t border-gray-primary mt-12 pt-4",children:[(0,d.jsx)("div",{className:"grid grid-cols-3 gap-8 mt-4 mb-12",children:t?t.length>0?t.map((e=>(0,d.jsxs)("div",{className:"relative group",children:[(0,d.jsx)("img",{src:e.imageSrc,alt:e.caption}),(0,d.jsxs)("div",{className:"absolute bottom-0 left-0 z-10 w-full h-full bg-gray-200 justify-evenly items-center  bg-black-faded group-hover:flex hidden",children:[(0,d.jsxs)("p",{className:"flex items-center text-white font-bold",children:[(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-8 mr-4",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),e.likes.length]}),(0,d.jsxs)("p",{className:"flex items-center text-white font-bold",children:[(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-8 mr-4",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})}),e.comments.length]})]})]},e.docId))):null:new Array(12).fill(0).map(((e,t)=>(0,d.jsx)(c.A,{width:320,height:400},t)))}),!t||0===t.length&&(0,d.jsx)("p",{className:"text-center text-2xl",children:"No Posts Yet"})]})}const h=e=>{let{user:t}=e;const[{profile:s,photosCollection:o,followerCount:l},a]=(0,n.useReducer)(((e,t)=>({...e,...t})),{profile:{},photosCollection:[],followerCout:0});return(0,n.useEffect)((()=>{t.username&&async function(){const e=await(0,r.j7)(t.username);console.log(e),a({profile:t,photosCollection:e,followerCount:t.followers.length})}()}),[t]),(0,d.jsxs)("div",{children:[(0,d.jsx)(u,{photosCount:o?o.length:0,profile:s,followerCount:l,setFollowerCount:a}),(0,d.jsx)(m,{photos:o})]})},f=()=>{const{username:e}=(0,o.g)(),[t,s]=(0,n.useState)(null),i=(0,o.Zp)();return(0,n.useEffect)((()=>{!async function(){const t=await(0,r.JE)(e);t.length>0?s(t[0]):i(l.p2)}()}),[e,i]),null!==t&&void 0!==t&&t.username?(0,d.jsxs)("div",{className:"bg-gray-background",children:[(0,d.jsx)(a.A,{}),(0,d.jsx)("div",{className:"mx-auto max-w-screen-lg",children:(0,d.jsx)(h,{user:t})})]}):null}},600:(e,t,s)=>{s.d(t,{JE:()=>r,JP:()=>l,K3:()=>m,So:()=>h,UD:()=>a,i$:()=>d,j7:()=>u,kO:()=>c,lP:()=>o,p_:()=>i});var n=s(474);async function o(e){return(await n.x.firestore().collection("users").where("username","==",e).get()).docs.map((e=>e.data().length>0))}async function r(e){const t=(await n.x.firestore().collection("users").where("username","==",e).get()).docs.map((e=>({...e.data(),docId:e.id})));return t.length>0&&t}async function l(e){return(await n.x.firestore().collection("users").where("userId","==",e).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function a(e,t){return(await n.x.firestore().collection("users").limit(10).get()).docs.map((e=>({...e.data(),docId:e.id}))).filter((s=>s.userId!==e&&!t.includes(s.userId)))}async function i(e,t,s){return n.x.firestore().collection("users").doc(e).update({following:s?n.S.arrayRemove(t):n.S.arrayUnion(t)})}async function c(e,t,s){return n.x.firestore().collection("users").doc(e).update({followers:s?n.S.arrayRemove(t):n.S.arrayUnion(t)})}async function d(e,t){const s=(await n.x.firestore().collection("photos").where("userId","in",t).get()).docs.map((e=>({...e.data(),docId:e.id})));return await Promise.all(s.map((async t=>{let s=!1;t.likes.includes(e)&&(s=!0);const n=await l(t.userId),{username:o}=n[0];return{username:o,...t,userLikedPhoto:s}})))}async function u(e){const[t]=await r(e);return(await n.x.firestore().collection("photos").where("userId","==",t.userId).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function m(e,t){const s=await n.x.firestore().collection("users").where("username","==",e).where("following","array-contains",t).get(),[o={}]=s.docs.map((e=>({...e.data(),docId:e.id})));return o.userId}async function h(e,t,s,n,o){await i(t,n,e),await c(s,o,e)}},372:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(43);const o=n.createContext({}),r=!0;function l(e){let{baseColor:t,highlightColor:s,width:n,height:o,borderRadius:l,circle:a,direction:i,duration:c,enableAnimation:d=r}=e;const u={};return"rtl"===i&&(u["--animation-direction"]="reverse"),"number"===typeof c&&(u["--animation-duration"]="".concat(c,"s")),d||(u["--pseudo-element-display"]="none"),"string"!==typeof n&&"number"!==typeof n||(u.width=n),"string"!==typeof o&&"number"!==typeof o||(u.height=o),"string"!==typeof l&&"number"!==typeof l||(u.borderRadius=l),a&&(u.borderRadius="50%"),"undefined"!==typeof t&&(u["--base-color"]=t),"undefined"!==typeof s&&(u["--highlight-color"]=s),u}function a(e){let{count:t=1,wrapper:s,className:a,containerClassName:i,containerTestId:c,circle:d=!1,style:u,...m}=e;var h,f,x;const g=n.useContext(o),p={...m};for(const[n,o]of Object.entries(m))"undefined"===typeof o&&delete p[n];const w={...g,...p,circle:d},j={...u,...l(w)};let y="react-loading-skeleton";a&&(y+=" ".concat(a));const v=null!==(h=w.inline)&&void 0!==h&&h,b=[],N=Math.ceil(t);for(let o=0;o<N;o++){let e=j;if(N>t&&o===N-1){const s=null!==(f=e.width)&&void 0!==f?f:"100%",n=t%1,o="number"===typeof s?s*n:"calc(".concat(s," * ").concat(n,")");e={...e,width:o}}const s=n.createElement("span",{className:y,style:e,key:o},"\u200c");v?b.push(s):b.push(n.createElement(n.Fragment,{key:o},s,n.createElement("br",null)))}return n.createElement("span",{className:i,"data-testid":c,"aria-live":"polite","aria-busy":null!==(x=w.enableAnimation)&&void 0!==x?x:r},s?b.map(((e,t)=>n.createElement(s,{key:t},e))):b)}}}]);
//# sourceMappingURL=870.fe9490e4.chunk.js.map